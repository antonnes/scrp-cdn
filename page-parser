(()=>{"use strict";class E{constructor(){this._entries={}}add(e,t){this._entries[e]?Array.isArray(t)?this._entries[e]=this._entries[e].concat(t):this._entries[e].push(t):this._entries[e]=Array.isArray(t)?t:[t]}get entries(){return this._entries}sort(){return Object.entries(this._entries).map(([e,t])=>({objectKey:e,objectArray:t})).sort((e,t)=>t.length-e.objectArray.length)}toArray(){return Object.values(this._entries)}}const h=["script","form","input","button","svg","path","select","option","optgroup","br","iframe"],d={classes:["price"],elements:["sup"],symbols:["\u043b\u0432","eur","$","\u20ac","\xa3"]};function f(s){let e=s.localName;return s.id&&(e+=`#${s.id}`),s.className&&"string"==typeof s.className&&s.className.length&&(e+=`.${s.className.replaceAll(" ",".")}`),e}function p(s,e){s&&Array.from(s.childNodes).forEach((t,r)=>{if(t.nodeType===Node.TEXT_NODE){const l=t.textContent?.trim();l&&g(l,t,e,r)}else if(t.nodeType===Node.ELEMENT_NODE){const l=t,n=l.textContent?.trim();!function _(s){const e={hasClass:!1,hasSup:!1,hasCurrency:!1};return d.classes.forEach(r=>{s.className.includes(r)&&(e.hasClass=!0)}),d.elements.forEach(r=>{s.querySelector(r)&&(e.hasSup=!0)}),Object.values(e).some(r=>r)}(l)?n&&g(n,t,e,r):e[y(n)]=f(l),p(l,e)}})}function g(s,e,t,r){const l=y(s);let n=f(e);e.nodeType===Node.TEXT_NODE&&(n=""),t[l]?n&&(t[l].elementSelector+=` > ${n}`):n?t[l]={elementSelector:n,text:s}:Object.keys(t).at(-1)?.includes(l)||(t[l]=Object.keys(t).find(a=>a.includes(l))?{elementSelector:`xpath:./text()[${r}]`,text:s}:{text:s})}function y(s){return s.replaceAll(" ","").replaceAll("\n","")}function N(s){let e=function w(s){let e=s.tagName.toLowerCase(),t=s.parentElement;for(;t&&"html"!==t.tagName.toLowerCase();){if(t.id)return`#${t.id} > ${e}`;if(t.className&&"string"==typeof t.className)return`.${t.className.trim().split(/\s+/).join(".")} > ${e}`;e=`${t.tagName.toLowerCase()} > ${e}`,t=t.parentElement}return e}(s);return s.id?(e+=s.id,`#${s.id}`):(s.className&&"string"==typeof s.className&&s.className.length&&(e+=`.${s.className.replaceAll(" ",".")}`),e)}function L(s){const e={};if(s.forEach(l=>e[l.selector]=(e[l.selector]||0)+1),0===Object.keys(e).length)return[];const t=Object.keys(e).reduce((l,n)=>e[l]>e[n]?l:n);if(e[t]/s.length<.5)return[];const r=[];for(let l=0;l<s.length;l++){const n=s[l];if(n.selector.startsWith(t)&&!h.includes(n.selector.localName)){const o=n.selector.indexOf(".")>=0?n.selector:n.selector+":not([class])";r.push({...n,realSelector:o,selector:n.selector})}}return r}function T(s){if(1===Object.keys(s).length)return;if(!s||"object"!=typeof s)throw new Error("Input must be a valid object");let e="";for(const t of Object.keys(s))t.length>e.length&&(e=t);e&&delete s[e]}!function C(s){const t=(new DOMParser).parseFromString(s,"text/html");let r=[];const l=new E;t.body.querySelectorAll("*").forEach(n=>{const o=n.className,a=N(n.parentElement);if(l.add(a,o),n.children.length>2&&!h.includes(n.localName)){const c=function O(s){const e=[];for(const t of Array.from(s)){const r=t;h.includes(r.localName)||e.push(r.className&&"string"==typeof r.className?{selector:"."+r.className.trim().split(/\s+/).join("."),element:t}:{selector:r.tagName.toLowerCase(),element:t})}return e}(n.children),m=N(n);r.push({children:c,classname:m})}});for(let n=0;n<r.length;n++)r[n].children=L(r[n].children);r.sort((n,o)=>o.children.length-n.children.length),r=r.slice(0,10);for(let n=0;n<r.length;n++){const o=r[n];for(let a=0;a<o.children.length;a++){const c={};p(o.children[a].element,c),console.log(c),T(c),o.children[a].content=Object.values(c)}}}(document.body.outerHTML)})();
